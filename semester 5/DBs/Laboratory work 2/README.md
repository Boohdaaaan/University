Лабораторна Робота #2
студента Кузнецова Богдана ТК-31

### 1. Аналіз даних для винесення в NoSQL

**Серед існуючих сутностей було б логічно винести повідомлення (`messages`) в документну базу, бо:**
1. повідомлення не оновлюються (тільки soft-delete)
2. у активних чатах можуть накопичуватися мільйони повідомлень
3. простий патерн читання даних - по `chat_id` + `created_at DESC` з пагінацією
4. можна легко додавати метадані (реакції, редагування, вкладення) без міграцій

**Також розглядав варіант винести `Audit_log`, бо:**
1. логи не оновлюються (тільки soft-delete)
2. у продакшн проектах можуть накопичуватися мільярди записів
3. простий патерн читання даних - по `timestamp DESC` з пагінацією

Але вирішив не додавати, бо
1. потрібні джойни з `users` для відображення email у UI
2. для аналітики потрібні складні запити (групування по `entity_name`, `action`) краще в SQL
3. PostgreSQL BRIN індекси дуже ефективні для великих append-only таблиць

Щоб винести ще якісь дані в NoSQL базу я вирішив додати портфоліо фрілансерів:

**Портфоліо фрілансерів (`portfolios`) вирішив зберігати в NoSQL, бо:**
1. різні типи робіт потребують різних полів (дизайн має кольорову палітру, розробка - технології, тощо)
2. можна легко додавати нові поля без міграцій (наприклад, відео-прев'ю, інтерактивні демо, метадані файлів)
3. можна зберігати всю інформацію про роботу в одному документі (фото, описи, технології, відгуки клієнтів)
4. простий патерн читання даних - по `freelancer_id` + `category` з фільтрацією
5. портфоліо створюється і оновлюється незалежно від інших сутностей

### 2. Обрання бази даних
Серед документних баз я вирішив обрати MongoDB через її популярність і простоту в інтеграції.

### 3. Імплементація та Тестування

Мої наступні кроки:
1. Створив docker-compose.yaml для запуску MongoDB та mongo-express (щоб дивитися дані в монго через UI)
2. Створив нові таблички для портфоліо (portfolios, portfolio_tags, portfolio_metrics, portfolio_images).
3. Написав функціонал додавання портфоліо в MongoDB та PostgreSQL.
4. Додав сторінку для порівняння швидкодії.
5. На малій кількості даних PostgreSQL швидше знаходив потрібні дані.
6. Для чесноти експерименту додав 5000 портфоліо в обидві бази даних.
7. Отримав результат, що MongoDB у середньому на 65% швидше повертає список портфоліо по заданим фільтрам.

Про процес тестування:
Тестування швидкості виконується через веб-інтерфейс на сторінці /portfolios/compare.
Користувач вказує параметри тесту: freelancer_id, category (опціонально) та кількість ітерацій (щоб отримати середнє значення).
Для кожної бази даних виконується однаковий запит: отримати всі портфоліо фрілансера з фільтрацією по категорії (якщо вказана) та сортуванням по created_at DESC.
Кожен запит виконується задану кількість разів, вимірюється час кожного виконання, після чого обчислюється середній час виконання в мілісекундах.

### 4. Інша NoSQL база. Key-Value - Redis.

Redis це key-value база, яку зазвичай використовують для кешування. Оскільки UI проекту дуже обмежений, кеш немає сенсу додавати, тому я просто зробив сторінку, на якій можна взаємодіяти з Redis (CRUD операції).
